<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>&lt;no title&gt; &mdash; Preprocessing 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Preprocessing 0.1 documentation" href="index.html" />
    <link rel="prev" title="Welcome to Preprocessing’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">fftpack</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">WORKSPACE_PATH</span> <span class="o">=</span> <span class="s1">&#39;/home/takeyama/pywork/ipython/2016-06-06/&#39;</span>
</pre></div>
</div>
<p>mozartの環境設定</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1">#p_path=&quot;/home/takeyama/pywork/ipython/2016-05-30/&quot;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1">#cd ~/Documents/SyncRecord/cleaning-addingLABEL/</span>
</pre></div>
</div>
<p>workstationの環境設定</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">Documents</span><span class="o">/</span><span class="n">AddingLabel</span><span class="o">+</span><span class="n">FFTdata</span><span class="o">/</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">takeyama</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">AddingLabel</span><span class="o">+</span><span class="n">FFTdata</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SensorData</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;__class__&quot;</span>
        <span class="c1"># raw data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="o">=</span><span class="p">{}</span>
        <span class="c1"># fft data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_FFTData</span><span class="o">=</span><span class="p">{}</span>
        <span class="c1"># power spectol data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_PowerData</span><span class="o">=</span><span class="p">{}</span>
        <span class="c1"># flag exsist data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Flag_exist_data</span><span class="o">=</span><span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">,</span><span class="s1">&#39;AccY&#39;</span><span class="p">,</span><span class="s1">&#39;AccZ&#39;</span><span class="p">,</span><span class="s1">&#39;GyrX&#39;</span><span class="p">,</span><span class="s1">&#39;GyrY&#39;</span><span class="p">,</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fft_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fft_AccX&#39;</span><span class="p">,</span><span class="s1">&#39;fft_AccY&#39;</span><span class="p">,</span><span class="s1">&#39;fft_AccZ&#39;</span><span class="p">,</span><span class="s1">&#39;fft_GyrX&#39;</span><span class="p">,</span><span class="s1">&#39;fft_GyrY&#39;</span><span class="p">,</span><span class="s1">&#39;fft_GyrZ&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;power_AccX&#39;</span><span class="p">,</span><span class="s1">&#39;power_AccY&#39;</span><span class="p">,</span><span class="s1">&#39;power_AccZ&#39;</span><span class="p">,</span><span class="s1">&#39;power_GyrX&#39;</span><span class="p">,</span><span class="s1">&#39;power_GyrY&#39;</span><span class="p">,</span><span class="s1">&#39;power_GyrZ&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">ImportCSV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sclass</span><span class="p">,</span><span class="n">csv_file</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ClassName</span><span class="o">=</span><span class="n">Sclass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Flag_exist_data</span><span class="o">=</span><span class="kc">True</span>
        <span class="c1"># design dataframe</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;SHIFT-JIS&quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">u&#39;Type&#39;</span><span class="p">,</span><span class="s1">u&#39;Time&#39;</span><span class="p">,</span><span class="s1">u&#39;AccX&#39;</span><span class="p">,</span><span class="s1">u&#39;AccY&#39;</span><span class="p">,</span><span class="s1">u&#39;AccZ&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrX&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrY&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrZ&#39;</span><span class="p">]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">Time</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">u&#39;AccX&#39;</span><span class="p">,</span><span class="s1">u&#39;AccY&#39;</span><span class="p">,</span><span class="s1">u&#39;AccZ&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrX&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrY&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrZ&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">u&#39;Time&#39;</span><span class="p">])</span>

        <span class="c1"># convert numpy.darray</span>
        <span class="n">AccX</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AccX</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.0001</span>
        <span class="n">AccY</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AccY</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.0001</span>
        <span class="n">AccZ</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AccZ</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.0001</span>
        <span class="n">GyrX</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">GyrX</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.01</span>
        <span class="n">GyrY</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">GyrY</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.01</span>
        <span class="n">GyrZ</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">GyrZ</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.01</span>
        <span class="n">Time</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">)</span>

        <span class="c1"># regist each raw data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccY</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccZ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GyrX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GyrY</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GyrZ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Time</span>

    <span class="k">def</span> <span class="nf">ShowFlagExistData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Flag_exist_data</span>

    <span class="k">def</span> <span class="nf">GetColumns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span>

    <span class="k">def</span> <span class="nf">GetTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">ShowAllDf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s1">&#39;AccX : &#39;</span><span class="p">;</span><span class="nb">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;AccY : &#39;</span><span class="p">;</span><span class="nb">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;AccZ : &#39;</span><span class="p">;</span><span class="nb">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;GyrX : &#39;</span><span class="p">;</span><span class="nb">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;GyrY : &#39;</span><span class="p">;</span><span class="nb">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;GyrZ : &#39;</span><span class="p">;</span><span class="nb">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_Time2Num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">time</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">ShowQuery</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sname</span><span class="p">,</span><span class="n">rng</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="n">Sname</span><span class="p">]</span>
        <span class="nb">print</span> <span class="n">Sname</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="n">rng</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">rng</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

    <span class="k">def</span> <span class="nf">_sliding_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sname</span><span class="p">,</span><span class="n">samp</span><span class="p">,</span> <span class="n">overlap</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span><span class="mi">0</span>
        <span class="n">s</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_Time2Num</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">s</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="n">samp</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
        <span class="n">goal</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Time2Num</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="n">Sname</span><span class="p">][</span><span class="n">start</span><span class="p">:</span><span class="n">goal</span><span class="p">]</span>

        <span class="n">add</span><span class="o">=</span><span class="n">overlap</span><span class="o">*</span><span class="mf">0.01</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span><span class="mi">1</span>
                <span class="n">s</span> <span class="o">=</span><span class="n">s</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="n">samp</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
                <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_Time2Num</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="n">g</span>  <span class="o">=</span><span class="n">s</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="n">samp</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
                <span class="n">goal</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Time2Num</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RawData</span><span class="p">[</span><span class="n">Sname</span><span class="p">][</span><span class="n">start</span><span class="p">:</span><span class="n">goal</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="nb">print</span> <span class="s1">&#39;_sliding_window StopIteration&#39;</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="nb">print</span> <span class="s1">&#39;_sliding_window IndexError&#39;</span>
                <span class="k">break</span>

<span class="c1"># Fast Frier transaction</span>
    <span class="k">def</span> <span class="nf">GetFFT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sfft</span><span class="p">,</span><span class="n">samp</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">p_path</span><span class="o">+</span><span class="s1">&#39;fft/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ClassName</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">Sfft</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">samp</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.npz&#39;</span><span class="p">)[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">CalcFFT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">samp</span><span class="p">,</span><span class="n">overlap</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">fft_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_fft_col</span><span class="p">):</span>
            <span class="nb">print</span> <span class="s1">&#39;start&#39;</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="s1">&#39;-&gt;&#39;</span><span class="o">+</span><span class="n">f</span>
            <span class="n">sw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sliding_window</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">samp</span><span class="p">,</span><span class="n">overlap</span><span class="p">)</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">d</span><span class="o">=</span><span class="n">sw</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                    <span class="n">fft_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fft_data</span><span class="p">,</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">d</span><span class="p">)[</span><span class="mi">1</span><span class="p">:(</span><span class="n">samp</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>   <span class="c1"># fftの直流成分を除くsample/2の</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="s1">&#39;CalcFFTStopIteration&#39;</span>
                    <span class="n">fft_data</span> <span class="o">=</span> <span class="n">fft_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft_data</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">samp</span><span class="o">/</span><span class="mi">2</span><span class="p">),(</span><span class="n">samp</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_FFTData</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">fft_data</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">p_path</span><span class="o">+</span><span class="s1">&#39;fft/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ClassName</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">samp</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_FFTData</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>
                    <span class="k">break</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;elapsed_time:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[sec]&quot;</span>


<span class="c1"># Spectol Power</span>
    <span class="k">def</span> <span class="nf">GetPower</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Spower</span><span class="p">,</span><span class="n">samp</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">p_path</span><span class="o">+</span><span class="s1">&#39;power/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ClassName</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">Spower</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">samp</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.npz&#39;</span><span class="p">)[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fft_array</span><span class="p">):</span>
        <span class="n">p</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">power_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">fft_array</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="n">power_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power_array</span><span class="p">,</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">power_array</span>

    <span class="k">def</span> <span class="nf">CalcPower</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">samp</span><span class="p">,</span><span class="n">overlap</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">fft_name</span><span class="p">,</span><span class="n">power_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fft_col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_power_col</span><span class="p">):</span>
            <span class="nb">print</span> <span class="s1">&#39;start&#39;</span><span class="o">+</span><span class="n">fft_name</span><span class="o">+</span><span class="s1">&#39;-&gt;&#39;</span><span class="o">+</span><span class="n">power_name</span>
            <span class="n">fft_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetFFT</span><span class="p">(</span><span class="n">fft_name</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
            <span class="n">power_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_power</span><span class="p">(</span><span class="n">fft_data</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">p_path</span><span class="o">+</span><span class="s1">&#39;power/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ClassName</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">power_name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">samp</span><span class="p">),</span><span class="n">power_data</span><span class="p">)</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;elapsed_time:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[sec]&quot;</span>
</pre></div>
</div>
<p>センサーのスタート時間を求める</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">SensorData</span><span class="p">()</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">SensorData</span><span class="p">()</span>
<span class="n">data3</span> <span class="o">=</span> <span class="n">SensorData</span><span class="p">()</span>
<span class="n">data4</span> <span class="o">=</span> <span class="n">SensorData</span><span class="p">()</span>
<span class="n">data5</span> <span class="o">=</span> <span class="n">SensorData</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">__class__</span>
<span class="n">__class__</span>
<span class="n">__class__</span>
<span class="n">__class__</span>
<span class="n">__class__</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;left_hand&#39;</span><span class="p">,</span><span class="s1">&#39;Conv-left-hand-ags.csv&#39;</span><span class="p">)</span>
<span class="n">data2</span><span class="o">.</span><span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;left_leg&#39;</span><span class="p">,</span><span class="s1">&#39;Conv-left-leg-ags.csv&#39;</span><span class="p">)</span>
<span class="n">data3</span><span class="o">.</span><span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;right_hand&#39;</span><span class="p">,</span><span class="s1">&#39;Conv-right-hand-ags.csv&#39;</span><span class="p">)</span>
<span class="n">data4</span><span class="o">.</span><span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;right_leg&#39;</span><span class="p">,</span><span class="s1">&#39;Conv-right-leg-ags.csv&#39;</span><span class="p">)</span>
<span class="n">data5</span><span class="o">.</span><span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;west&#39;</span><span class="p">,</span><span class="s1">&#39;Conv-west-ags.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">time1</span><span class="o">=</span><span class="n">data1</span><span class="o">.</span><span class="n">GetTime</span><span class="p">()</span>
<span class="n">time2</span><span class="o">=</span><span class="n">data2</span><span class="o">.</span><span class="n">GetTime</span><span class="p">()</span>
<span class="n">time3</span><span class="o">=</span><span class="n">data3</span><span class="o">.</span><span class="n">GetTime</span><span class="p">()</span>
<span class="n">time4</span><span class="o">=</span><span class="n">data4</span><span class="o">.</span><span class="n">GetTime</span><span class="p">()</span>
<span class="n">time5</span><span class="o">=</span><span class="n">data5</span><span class="o">.</span><span class="n">GetTime</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">time1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">time2</span><span class="p">):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">time2</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">time1</span><span class="p">)</span>

<span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">time3</span><span class="p">):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">time3</span><span class="p">)</span>

<span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">time4</span><span class="p">):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">time4</span><span class="p">)</span>

<span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">time5</span><span class="p">):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">time5</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">MAX</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">2016</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">10</span><span class="n">T18</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">15.877000000</span>
</pre></div>
</div>
<p>Conv-から始まるファイルはすでにhh:mm:ssSSのように変換されている。
しかし、この形では四捨五入といった丸めることができない。</p>
<p>よって、最初のmsの状態で位置の桁を四捨五入すれば簡単に丸めることができるのではないだろうか？
試しに、値をleft-hand.csvの時刻から四捨五入して、hh:mm:ssSSの形に直してみる。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">55844456</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ms]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">456000</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ms]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="mi">55844456</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1970-01-01T15:30:44.456&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">(</span><span class="mi">55844456</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">55844460.0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="mi">55844456</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span>
<span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1970-01-01T15:30:44.460&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="mi">55844456</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1970-01-01T15:30:44.456&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>CSVファイルをnumpyで読み込んでクラスのインポートと同じような動作ができるかどうかやってみる。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&quot;left-hand.csv&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#時間の列だけを抽出</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span> <span class="nb">map</span><span class="p">(</span> <span class="n">func</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1970-01-01T18:06:15.700&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="mi">55844456</span><span class="p">,</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1970-01-01T15:30:44.456&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>前処理クラス　時系列の統一　アルゴリズム　考案　2016-06-07</p>
<p>現在の作業状況の途中経過をここにメモする。
まずは、肝心の時系列だがpandasで読み込むよりnumpy.loadcsv使ったほうが正確である
しかし、この読み込み方法だと問題が１つある。それは、加速度データがなぜかよみこまれない
からである。
一番怪しいのは、マイナスとか符号が原因でエラーが起きているのではないかと考える。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1">#sampling freqency</span>
<span class="n">samp</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<p>サンプリング周波数を決め、切り上げ、切り捨て、四捨五入を関数を使用しないで実装してみる
この計算では各データの単位はmsで行う。
理由として、csvファイルの時刻は当日０時から経過したmsであるから</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&quot;left-hand.csv&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#時間の列だけを抽出</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">time</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">65175696.</span><span class="p">,</span>  <span class="mf">65175706.</span><span class="p">,</span>  <span class="mf">65175716.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">65730376.</span><span class="p">,</span>  <span class="mf">65730386.</span><span class="p">,</span>
        <span class="mf">65730396.</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1">#切り捨て</span>
<span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">/</span><span class="n">samp</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="n">samp</span>
<span class="n">output</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">65175690</span><span class="p">,</span> <span class="mi">65175700</span><span class="p">,</span> <span class="mi">65175710</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65730370</span><span class="p">,</span> <span class="mi">65730380</span><span class="p">,</span> <span class="mi">65730390</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1">#切り上げ</span>
<span class="n">output</span> <span class="o">=</span> <span class="p">((</span><span class="n">time</span><span class="o">+</span><span class="n">samp</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="n">samp</span>
<span class="n">output</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">65175700</span><span class="p">,</span> <span class="mi">65175710</span><span class="p">,</span> <span class="mi">65175720</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65730380</span><span class="p">,</span> <span class="mi">65730390</span><span class="p">,</span> <span class="mi">65730400</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1">#四捨五入</span>
<span class="n">output</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">time</span><span class="o">+</span><span class="n">samp</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="n">samp</span>
<span class="n">output</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">65175700</span><span class="p">,</span> <span class="mi">65175710</span><span class="p">,</span> <span class="mi">65175720</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65730380</span><span class="p">,</span> <span class="mi">65730390</span><span class="p">,</span> <span class="mi">65730400</span><span class="p">])</span>
</pre></div>
</div>
<p>結局、最初のデータは時間を指すことはわかるが、２番めの数字は元データをみても該当するものはない。
よって、２通りのCSV読む方法を取る。１つはpandas、もう１つはnumpy.loadtxtである。
pandasのほうでは、加速度、角速度を読み込む
numpyのほうでは、時系列を読み込む</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">csv_file -&gt; ファイル名</span>
<span class="sd">mode Round -&gt; 四捨五入</span>
<span class="sd">     Roundup -&gt; 切り上げ</span>
<span class="sd">     Rounddown -&gt; 切り捨て</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="k">def</span> <span class="nf">ImportCSV</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span><span class="n">samp</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;Round&#39;</span><span class="p">):</span>
        <span class="c1"># data dictionary</span>
        <span class="n">RawData</span><span class="o">=</span><span class="p">{}</span>

        <span class="c1"># design dataframe and import csv</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;SHIFT-JIS&quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">u&#39;Type&#39;</span><span class="p">,</span><span class="s1">u&#39;Time&#39;</span><span class="p">,</span><span class="s1">u&#39;AccX&#39;</span><span class="p">,</span><span class="s1">u&#39;AccY&#39;</span><span class="p">,</span><span class="s1">u&#39;AccZ&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrX&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrY&#39;</span><span class="p">,</span><span class="s1">u&#39;GyrZ&#39;</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ags&#39;</span><span class="p">]</span>

        <span class="c1"># convert numpy.darray</span>
        <span class="c1"># Acc Data  [0.1mG]=&gt;[G]</span>
        <span class="c1"># Gyr Data  [0.01dps]=&gt;[dps]   ...dps=degree per second</span>
        <span class="n">AccX</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AccX</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.0001</span>
        <span class="n">AccY</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AccY</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.0001</span>
        <span class="n">AccZ</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">AccZ</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.0001</span>
        <span class="n">GyrX</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">GyrX</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.01</span>
        <span class="n">GyrY</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">GyrY</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.01</span>
        <span class="n">GyrZ</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">GyrZ</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">0.01</span>

        <span class="c1"># regist each raw data</span>
        <span class="n">RawData</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccX</span>
        <span class="n">RawData</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccY</span>
        <span class="n">RawData</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccZ</span>
        <span class="n">RawData</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GyrX</span>
        <span class="n">RawData</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GyrY</span>
        <span class="n">RawData</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GyrZ</span>

        <span class="c1"># import time by using numpy</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">values</span> <span class="c1">#時間の列だけを抽出</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Roundup&#39;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">samp</span><span class="p">)</span><span class="o">*</span><span class="n">samp</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Rounddown&#39;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">samp</span><span class="p">)</span><span class="o">*</span><span class="n">samp</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Round&#39;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">samp</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">)</span><span class="o">*</span><span class="n">samp</span>
        <span class="c1">#ERROR</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;check mode and inputed word is caused error&#39;</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">output</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">time</span><span class="p">)</span>
        <span class="n">RawData</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
        <span class="k">return</span> <span class="n">RawData</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check1</span> <span class="o">=</span> <span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;left-hand.csv&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="mi">66</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65176370</span>
</pre></div>
</div>
<p>この関数を使用することによって、切り捨て切り上げ、四捨五入を行い
時系列の時間を10msごとのデータになった -&gt;1の桁はゼロである</p>
<p>次に、各データの時系列を同期する</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check2</span> <span class="o">=</span> <span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;left-leg.csv&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">check3</span> <span class="o">=</span> <span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;right-hand.csv&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">check4</span> <span class="o">=</span> <span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;right-leg.csv&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">check5</span> <span class="o">=</span> <span class="n">ImportCSV</span><span class="p">(</span><span class="s1">&#39;west.csv&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>センサの時系列の最小値を求める。そして、それぞれの最小値を比較して
その中で一番大きい値をスタート時間とする</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="nb">print</span> <span class="n">MAX</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="nb">min</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">min</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">min</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">min</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">min</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175710</span>
<span class="mi">65175890</span>
<span class="mi">65175670</span>
<span class="mi">65175810</span>
<span class="mi">65175760</span>
</pre></div>
</div>
<p>センサの時系列の最大値を求める。そして、それぞれの最大値を比較して
その中で一番小さい値をスタート時間とする</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">MIN</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">MIN</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">MIN</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]):</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>

<span class="nb">print</span> <span class="n">MIN</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65730150</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="nb">max</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">max</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">max</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">max</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="nb">max</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65730400</span>
<span class="mi">65730970</span>
<span class="mi">65730150</span>
<span class="mi">65730810</span>
<span class="mi">65730620</span>
</pre></div>
</div>
<p>各センサの時系列データをスタート時間を０番目となるようにする</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">18</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">22</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">8</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
            <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">13</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<p>上記の方法で求めたスタート時間とゴール時間の間を扱う。
しかし、その区間にもセンサによっては取得できてない可能性もあるので確認する</p>
<p>手法としては、スタート時間からゴール時間をステップ+10とした連続値の配列を作成する
各センサデータの時系列はこの配列（以後、参照配列と呼称する）と比較してNANがあるかどうか調べる
NANがある場合、同じ大きさの配列のフラグにFalseを入れる。ない場合はTrueを入れる</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">ReferenceIndex</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">65175890</span><span class="p">,</span><span class="mi">65730150</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Flag_ExistData</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check1&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">))</span>
<span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check2&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">))</span>
<span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check3&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">))</span>
<span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check4&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">))</span>
<span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check5&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">))</span>
</pre></div>
</div>
<p>2016-6-8
以後、行われていることはReferenceIndexと各データcheck1-5で違う時間
をもっているかどうか
つまり、スタート時間からゴール時間のデータを各データは保持している
かどうかを調査する</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">checkData</span> <span class="o">=</span> <span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">startNum</span><span class="o">=</span><span class="n">i</span>
        <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">startNum</span><span class="o">=</span><span class="mi">0</span>
    <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">startNum</span><span class="p">]</span><span class="o">==</span><span class="n">ReferenceIndex</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
        <span class="c1">#print str(i)+&#39; is all sensor data complete&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check1&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print str(i)+&#39; is data has nan data&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check1&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">count</span> <span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span> <span class="n">count</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">18</span>
<span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">checkData</span> <span class="o">=</span> <span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">startNum</span><span class="o">=</span><span class="n">i</span>
        <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">startNum</span><span class="o">=</span><span class="mi">0</span>
    <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">startNum</span><span class="p">]</span><span class="o">==</span><span class="n">ReferenceIndex</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
        <span class="c1">#print str(i)+&#39; is all sensor data complete&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check2&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print str(i)+&#39; is data has nan data&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check2&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">count</span> <span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span> <span class="n">count</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">0</span>
<span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">checkData</span> <span class="o">=</span> <span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">startNum</span><span class="o">=</span><span class="n">i</span>
        <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">startNum</span><span class="o">=</span><span class="mi">0</span>
    <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">startNum</span><span class="p">]</span><span class="o">==</span><span class="n">ReferenceIndex</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
        <span class="c1">#print str(i)+&#39; is all sensor data complete&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check3&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print str(i)+&#39; is data has nan data&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check3&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">count</span> <span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span> <span class="n">count</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">22</span>
<span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">checkData</span> <span class="o">=</span> <span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)):</span>
    <span class="k">if</span> <span class="mi">65175890</span> <span class="o">==</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">startNum</span><span class="o">=</span><span class="n">i</span>
        <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">startNum</span><span class="o">=</span><span class="mi">0</span>
    <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ReferenceIndex</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">startNum</span><span class="p">]</span><span class="o">==</span><span class="n">ReferenceIndex</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
        <span class="c1">#print str(i)+&#39; is all sensor data complete&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check4&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print str(i)+&#39; is data has nan data&#39;</span>
        <span class="n">Flag_ExistData</span><span class="p">[</span><span class="s1">&#39;check4&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">count</span> <span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span> <span class="n">count</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">8</span>
<span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">count = 0</span>
<span class="sd">checkData = check5[&#39;Time&#39;]</span>
<span class="sd">i=0</span>
<span class="sd">for i in range(0, len(checkData)):</span>
<span class="sd">    if 65175890 == checkData[i]:</span>
<span class="sd">        startNum=i</span>
<span class="sd">        print &#39;start index number is &#39;+str(i)</span>
<span class="sd">        break</span>

<span class="sd">if i == len(checkData)-1:</span>
<span class="sd">    startNum=0</span>
<span class="sd">    print &#39;start index number is &#39;+str(0)</span>

<span class="sd">for i in range(0, 55426):</span>
<span class="sd">    print checkData[i+startNum]</span>
<span class="sd">    if (checkData[i+startNum]==ReferenceIndex[i]):</span>
<span class="sd">        #print str(i)+&#39; is all sensor data complete&#39;</span>
<span class="sd">        Flag_ExistData[&#39;check5&#39;][i]=True</span>
<span class="sd">    else:</span>
<span class="sd">        #print str(i)+&#39; is data has nan data&#39;</span>
<span class="sd">        Flag_ExistData[&#39;check5&#39;][i]=False</span>
<span class="sd">        count +=1</span>
<span class="sd">print count</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
<pre class="literal-block">
&quot;ncount = 0ncheckData = check5['Time']ni=0nfor i in range(0, len(checkData)):n    if 65175890 == checkData[i]:n        startNum=in        print 'start index number is '+str(i)n        breakn        nif i == len(checkData)-1:n    startNum=0n    print 'start index number is '+str(0)nnfor i in range(0, 55426):n    print checkData[i+startNum]n    if (checkData[i+startNum]==ReferenceIndex[i]):n        #print str(i)+' is all sensor data complete'n        Flag_ExistData['check5'][i]=Truen    else:n        #print str(i)+' is data has nan data'n        Flag_ExistData['check5'][i]=Falsen        count +=1nprint countn&quot;
</pre>
<p>上のアルゴリズムのについての原因を考える。原因は、check5の配列の長さが54992あるのに対して
ReferenceIndexの長さは55426である。共通区間はあくまでも各データの時系列のデータの長さより小さくなければ
共通という意味に矛盾する。つまり、ここが原因なのではないかと考える。</p>
<p>確認方法として、配列の前後の差を調べる。そして、差が10以外のデータのインデックスを探す</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">checkData</span> <span class="o">=</span> <span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">diff</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">diff_index</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="o">!=</span><span class="mi">10</span><span class="p">:</span>
        <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">diff_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s1">&#39;Error Index Num=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">checkData</span> <span class="o">=</span> <span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">diff</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">diff_index</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="o">!=</span><span class="mi">10</span><span class="p">:</span>
        <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">diff_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s1">&#39;Error Index Num=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">checkData</span> <span class="o">=</span> <span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">diff</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">diff_index</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="o">!=</span><span class="mi">10</span><span class="p">:</span>
        <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">diff_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s1">&#39;Error Index Num=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">checkData</span> <span class="o">=</span> <span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">diff</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">diff_index</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="o">!=</span><span class="mi">10</span><span class="p">:</span>
        <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">diff_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s1">&#39;Error Index Num=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># zero patting</span>
<span class="n">checkData</span> <span class="o">=</span> <span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
<span class="n">diff</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">diff_index</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="o">!=</span><span class="mi">10</span><span class="p">:</span>
        <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">diff_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s1">&#39;Error Index Num=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5589</span> <span class="n">diff</span><span class="o">=</span><span class="mi">1330</span>
<span class="mi">5589</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65231650</span>
<span class="mi">5590</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65232980</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5650</span> <span class="n">diff</span><span class="o">=</span><span class="mi">3000</span>
<span class="mi">5650</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65233580</span>
<span class="mi">5651</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65236580</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5813</span> <span class="n">diff</span><span class="o">=</span><span class="mi">90</span>
<span class="mi">5813</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238200</span>
<span class="mi">5814</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238290</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5870</span> <span class="n">diff</span><span class="o">=</span><span class="mi">430</span>
<span class="mi">5870</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238850</span>
<span class="mi">5871</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65239280</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6266</span> <span class="n">diff</span><span class="o">=</span><span class="mi">140</span>
<span class="mi">6266</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243230</span>
<span class="mi">6267</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243370</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6302</span> <span class="n">diff</span><span class="o">=</span><span class="mi">20</span>
<span class="mi">6302</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243720</span>
<span class="mi">6303</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243740</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">diff</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1330</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">diff_index</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">5589</span><span class="p">,</span> <span class="mi">5650</span><span class="p">,</span> <span class="mi">5813</span><span class="p">,</span> <span class="mi">5870</span><span class="p">,</span> <span class="mi">6266</span><span class="p">,</span> <span class="mi">6302</span><span class="p">]</span>
</pre></div>
</div>
<p>2016-06-09</p>
<p>歯抜けデータがあったときの対象法２
歯抜けしたデータを別の値で埋めるというzero pattingというやり方をする。</p>
<ol class="arabic simple">
<li>diff,
diff_indexに差が１０位外のときの差、その差が生じた時のインデックスを格納する。</li>
<li>diff_indexに格納されているインデックス番号までのデータをtmpに格納する</li>
<li>diff_indexに格納されている。10で割ることによって不足している要素数がわかるので、その要素数分までnanを格納する</li>
</ol>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">checkData</span> <span class="o">=</span> <span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>

<span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="k">for</span> <span class="n">count</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">diff_index</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">l</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">diff</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span>
<span class="n">tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:])</span>
<span class="nb">print</span> <span class="n">tmp</span>
<span class="c1">#print len(tmp)</span>

<span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">start_time</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;elapsed_time:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[sec]&quot;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">65175760.</span>  <span class="mf">65175770.</span>  <span class="mf">65175780.</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">65730600.</span>  <span class="mf">65730610.</span>  <span class="mf">65730620.</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.0156850814819</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
</pre></div>
</div>
<p>歯抜けデータがあったときの対象1</p>
<p>歯抜けしたインデックスを区切って別のデータとして保存</p>
<ol class="arabic simple">
<li>diff,
diff_indexに差が１０位外のときの差、その差が生じた時のインデックスを格納する。</li>
<li>1.の処理をすべてのセンサーに行う</li>
<li>diff_indexをソートする</li>
<li>diff_indexの奇数から偶数番目の区間が共通区間であるからその区間のインデックスを出す</li>
</ol>
<p>対象法１　ステップ１　歯抜けデータのインデックス、そしてそのインデックス</p>
<p>ある配列に配列を加えたとき、[1,2,3],[1,3,4]にするためには np.append(
daat, np.array(), axis=0)</p>
<p>この関数の仕様を決める。入力データは歯抜けのあるデータとする。
さっきのアルゴリズムの4番目に追加する。 5.
その区間の長さをサンプル数に応じた長さで配列を抽出する</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">samp</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">diff_index</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">6</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">diff_index</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">AttributeError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">86</span><span class="o">-</span><span class="mi">0</span><span class="n">d2121312de2</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">diff_index</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>


<span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;shape&#39;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span> <span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p><strong>2016-06-10</strong> *** 以下のアルゴリズムについて説明する。
これのアルゴリズムの目的は、NANデータを含まないが時系列が非連続となっているデータから
連続となっている時系列を抽出し、そして抽出したデータを列(width)がサンプル数となるようにして出力する。</p>
<p>目的と重複してしまうが、対象とする入力、出力データは
入力データ　＝　NANデータを含まないが時系列が非連続となっているデータ
出力データ　＝　連続となっている時系列を抽出し、そして抽出したデータを列(width)がサンプル数となるデータ</p>
<p>アルゴリズムの流れは
ある１つの時刻データから連続となっている部分の最後をdiff_indexに格納する。また、そして格納した時間と次のインデックスの
時間の差をdiffに格納する。
diff_indexのインデックスと連続となっている部分の最初のデータを抽出する。
そして、抽出したデータをwidthをsample数にする。
気をつけるとすると、抽出したデータの要素数がサンプル数以上であることが出力する条件である。</p>
<p>スタート時間をもとめるプログラム</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ClacStartTime</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">return</span>  <span class="n">MAX</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">SensorStartTime</span><span class="o">=</span><span class="n">ClacStartTime</span><span class="p">([</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]])</span>
<span class="n">SensorStartTime</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<p>ゴール時間をもとめるプログラム</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ClacGoalTime</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">MIN</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">return</span>  <span class="n">MIN</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">SensorGoalTime</span><span class="o">=</span><span class="n">ClacGoalTime</span><span class="p">([</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]])</span>
<span class="n">SensorGoalTime</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65730150</span>
</pre></div>
</div>
<p>SensorStartTimeに定義した時間を格納した各センサの時系列のインデックスを算出する</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">checkData</span><span class="p">,</span><span class="n">CompareTime</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">CompareTime</span> <span class="o">==</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">startNum</span><span class="o">=</span><span class="n">i</span>
            <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">startNum</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">SensorStartTime</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">SensorGoalTime</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">55426</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">55426</span>
</pre></div>
</div>
<p>diff_index,diffに時系列データからあるインデックスとその次のインデックスのデータの差が10msではないインデックス
をdiff_indexにすべて格納する。そして、その時の差をdiffに格納する。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CalcDiffTimeArray</span><span class="p">(</span><span class="n">checkData</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">diff_index</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="o">!=</span><span class="mi">10</span><span class="p">:</span>
            <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">diff_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="nb">print</span> <span class="s1">&#39;Error Index Num=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
            <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">diff_index</span><span class="p">,</span><span class="n">diff</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5589</span> <span class="n">diff</span><span class="o">=</span><span class="mi">1330</span>
<span class="mi">5589</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65231650</span>
<span class="mi">5590</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65232980</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5650</span> <span class="n">diff</span><span class="o">=</span><span class="mi">3000</span>
<span class="mi">5650</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65233580</span>
<span class="mi">5651</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65236580</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5813</span> <span class="n">diff</span><span class="o">=</span><span class="mi">90</span>
<span class="mi">5813</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238200</span>
<span class="mi">5814</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238290</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5870</span> <span class="n">diff</span><span class="o">=</span><span class="mi">430</span>
<span class="mi">5870</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238850</span>
<span class="mi">5871</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65239280</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6266</span> <span class="n">diff</span><span class="o">=</span><span class="mi">140</span>
<span class="mi">6266</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243230</span>
<span class="mi">6267</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243370</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6302</span> <span class="n">diff</span><span class="o">=</span><span class="mi">20</span>
<span class="mi">6302</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243720</span>
<span class="mi">6303</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243740</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([</span><span class="mi">5589</span><span class="p">,</span> <span class="mi">5650</span><span class="p">,</span> <span class="mi">5813</span><span class="p">,</span> <span class="mi">5870</span><span class="p">,</span> <span class="mi">6266</span><span class="p">,</span> <span class="mi">6302</span><span class="p">],</span> <span class="p">[</span><span class="mi">1330</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
<p>与えられた配列と、差が10ms生じるインデックスとその差の変数を2つ使って連続データを抽出し、そしてサンプル数に応じた幅の変数を返す</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CalcWindow</span><span class="p">(</span><span class="n">checkData</span><span class="p">,</span><span class="n">diff_index</span><span class="p">,</span><span class="n">diff</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">OuputData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">samp</span><span class="p">)</span>

    <span class="c1"># researve tmp%samp</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_index</span><span class="p">)</span> <span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span><span class="p">)]</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
        <span class="n">axis</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">remainder</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span>

        <span class="c1"># tmp elements must be over sample num</span>
        <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">samp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">axis</span> <span class="p">):</span>
                <span class="n">OuputData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OuputData</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]))</span>
        <span class="n">start</span> <span class="o">=</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span> <span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span><span class="p">)]</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
    <span class="n">axis</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">remainder</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span>

    <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">samp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">axis</span> <span class="p">):</span>
                <span class="n">OuputData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OuputData</span><span class="p">,</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>

    <span class="n">OuputData</span> <span class="o">=</span> <span class="n">OuputData</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">OuputData</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>

    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">start_time</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;elapsed_time:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[sec]&quot;</span>
    <span class="k">return</span> <span class="n">OuputData</span>
</pre></div>
</div>
<p>下のアルゴリズムは、時系列データからあるインデックスとその次のインデックスのデータの差が10msではないインデックス
をdiff_indexにすべて格納する。そして、その時の差をdiffに格納する。</p>
<p>そして、そのデータを変数を使って、非連続な時系列データから連続データを取り出す。
その方法は、そのdiff_indexの一つ前までを連続な時系列データであるとする。そして、そこまでの配列を
別の変数に格納する。そして、新たに作成した変数を列(width)をサンプル数にして、出力する変数に格納する。
また、このときのdiff_indexの値に+1をしたインデックス番号を次の連続な時系列データの区間のスタートとする。</p>
<p>diff_indexによって分けられた区間分の抽出が終わったら、残りをさきほど同様な流れで出力する変数に加える。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">goal</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">checkData</span> <span class="o">=</span> <span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>

<span class="n">Output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_index</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Ouput</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">samp</span><span class="p">)</span>

<span class="c1"># researve tmp%samp</span>
<span class="n">remainder</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_index</span><span class="p">)</span> <span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span> <span class="p">)</span>
    <span class="n">remainder</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span><span class="p">)]</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
    <span class="n">axis</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">shape</span>
    <span class="nb">print</span> <span class="s1">&#39;start=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff_index=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; Non-Resize-element &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">&#39;axis=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; width=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; All elements=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="c1"># tmp elements must be over sample num</span>
    <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">samp</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">axis</span> <span class="p">):</span>
            <span class="n">Output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Output</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]))</span>
    <span class="n">start</span> <span class="o">=</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
    <span class="nb">print</span> <span class="s1">&#39;__tmp.elements &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">&#39;__Output.elements &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Output</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">&#39;__Remainder &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">remainder</span><span class="p">)</span>


<span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span> <span class="p">)</span>
<span class="n">remainder</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span><span class="p">)]</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
<span class="n">axis</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">shape</span>
<span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">samp</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">axis</span> <span class="p">):</span>
            <span class="n">Output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Output</span><span class="p">,</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>

<span class="n">Output</span> <span class="o">=</span> <span class="n">Output</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Output</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;__tmp.elements &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;__Output.elements &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Output</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;__Remainder &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">remainder</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">Output</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span> <span class="n">Output</span>
<span class="c1">#print len(tmp)</span>

<span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">start_time</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;elapsed_time:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[sec]&quot;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span><span class="o">=</span><span class="mi">0</span> <span class="n">diff_index</span><span class="o">=</span><span class="mi">5589</span> <span class="n">Non</span><span class="o">-</span><span class="n">Resize</span><span class="o">-</span><span class="n">element</span> <span class="mi">5589</span>
<span class="n">axis</span><span class="o">=</span><span class="mi">698</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span> <span class="n">All</span> <span class="n">elements</span><span class="o">=</span><span class="mi">5584</span>
<span class="n">__tmp</span><span class="o">.</span><span class="n">elements</span> <span class="mi">5584</span>
<span class="n">__Output</span><span class="o">.</span><span class="n">elements</span> <span class="mi">5584</span>
<span class="n">__Remainder</span> <span class="mi">5</span>
<span class="n">start</span><span class="o">=</span><span class="mi">5590</span> <span class="n">diff_index</span><span class="o">=</span><span class="mi">5650</span> <span class="n">Non</span><span class="o">-</span><span class="n">Resize</span><span class="o">-</span><span class="n">element</span> <span class="mi">60</span>
<span class="n">axis</span><span class="o">=</span><span class="mi">7</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span> <span class="n">All</span> <span class="n">elements</span><span class="o">=</span><span class="mi">56</span>
<span class="n">__tmp</span><span class="o">.</span><span class="n">elements</span> <span class="mi">56</span>
<span class="n">__Output</span><span class="o">.</span><span class="n">elements</span> <span class="mi">5640</span>
<span class="n">__Remainder</span> <span class="mi">9</span>
<span class="n">start</span><span class="o">=</span><span class="mi">5651</span> <span class="n">diff_index</span><span class="o">=</span><span class="mi">5813</span> <span class="n">Non</span><span class="o">-</span><span class="n">Resize</span><span class="o">-</span><span class="n">element</span> <span class="mi">162</span>
<span class="n">axis</span><span class="o">=</span><span class="mi">20</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span> <span class="n">All</span> <span class="n">elements</span><span class="o">=</span><span class="mi">160</span>
<span class="n">__tmp</span><span class="o">.</span><span class="n">elements</span> <span class="mi">160</span>
<span class="n">__Output</span><span class="o">.</span><span class="n">elements</span> <span class="mi">5800</span>
<span class="n">__Remainder</span> <span class="mi">11</span>
<span class="n">start</span><span class="o">=</span><span class="mi">5814</span> <span class="n">diff_index</span><span class="o">=</span><span class="mi">5870</span> <span class="n">Non</span><span class="o">-</span><span class="n">Resize</span><span class="o">-</span><span class="n">element</span> <span class="mi">56</span>
<span class="n">axis</span><span class="o">=</span><span class="mi">7</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span> <span class="n">All</span> <span class="n">elements</span><span class="o">=</span><span class="mi">56</span>
<span class="n">__tmp</span><span class="o">.</span><span class="n">elements</span> <span class="mi">56</span>
<span class="n">__Output</span><span class="o">.</span><span class="n">elements</span> <span class="mi">5856</span>
<span class="n">__Remainder</span> <span class="mi">11</span>
<span class="n">start</span><span class="o">=</span><span class="mi">5871</span> <span class="n">diff_index</span><span class="o">=</span><span class="mi">6266</span> <span class="n">Non</span><span class="o">-</span><span class="n">Resize</span><span class="o">-</span><span class="n">element</span> <span class="mi">395</span>
<span class="n">axis</span><span class="o">=</span><span class="mi">49</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span> <span class="n">All</span> <span class="n">elements</span><span class="o">=</span><span class="mi">392</span>
<span class="n">__tmp</span><span class="o">.</span><span class="n">elements</span> <span class="mi">392</span>
<span class="n">__Output</span><span class="o">.</span><span class="n">elements</span> <span class="mi">6248</span>
<span class="n">__Remainder</span> <span class="mi">14</span>
<span class="n">start</span><span class="o">=</span><span class="mi">6267</span> <span class="n">diff_index</span><span class="o">=</span><span class="mi">6302</span> <span class="n">Non</span><span class="o">-</span><span class="n">Resize</span><span class="o">-</span><span class="n">element</span> <span class="mi">35</span>
<span class="n">axis</span><span class="o">=</span><span class="mi">4</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span> <span class="n">All</span> <span class="n">elements</span><span class="o">=</span><span class="mi">32</span>
<span class="n">__tmp</span><span class="o">.</span><span class="n">elements</span> <span class="mi">32</span>
<span class="n">__Output</span><span class="o">.</span><span class="n">elements</span> <span class="mi">6280</span>
<span class="n">__Remainder</span> <span class="mi">17</span>
<span class="n">__tmp</span><span class="o">.</span><span class="n">elements</span> <span class="mi">48688</span>
<span class="n">__Output</span><span class="o">.</span><span class="n">elements</span> <span class="mi">54968</span>
<span class="n">__Remainder</span> <span class="mi">18</span>
<span class="p">(</span><span class="mi">6871</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">[[</span><span class="mi">65175760</span> <span class="mi">65175770</span> <span class="mi">65175780</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65175810</span> <span class="mi">65175820</span> <span class="mi">65175830</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">65175840</span> <span class="mi">65175850</span> <span class="mi">65175860</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65175890</span> <span class="mi">65175900</span> <span class="mi">65175910</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">65175920</span> <span class="mi">65175930</span> <span class="mi">65175940</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65175970</span> <span class="mi">65175980</span> <span class="mi">65175990</span><span class="p">]</span>
 <span class="o">...</span><span class="p">,</span>
 <span class="p">[</span><span class="mi">65730380</span> <span class="mi">65730390</span> <span class="mi">65730400</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65730430</span> <span class="mi">65730440</span> <span class="mi">65730450</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">65730460</span> <span class="mi">65730470</span> <span class="mi">65730480</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65730510</span> <span class="mi">65730520</span> <span class="mi">65730530</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">65730540</span> <span class="mi">65730550</span> <span class="mi">65730560</span> <span class="o">...</span><span class="p">,</span> <span class="mi">65730590</span> <span class="mi">65730600</span> <span class="mi">65730610</span><span class="p">]]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.153914928436</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>*&#8212;&#8212;&#8212;&#8212;&#8211;計算で使用する書く計算&#8212;&#8212;&#8212;&#8212;&#8211;*</strong></p>
<p>スタート時間をもとめるプログラム</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ClacStartTime</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">MAX</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">MAX</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">return</span>  <span class="n">MAX</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">SensorStartTime</span><span class="o">=</span><span class="n">ClacStartTime</span><span class="p">([</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]])</span>
<span class="n">SensorStartTime</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65175890</span>
</pre></div>
</div>
<p>ゴール時間をもとめるプログラム</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ClacGoalTime</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">MIN</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">MIN</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">return</span>  <span class="n">MIN</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">SensorGoalTime</span><span class="o">=</span><span class="n">ClacGoalTime</span><span class="p">([</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]])</span>
<span class="n">SensorGoalTime</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">65730150</span>
</pre></div>
</div>
<p>SensorStartTimeに定義した時間を格納した各センサの時系列のインデックスを算出する</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">checkData</span><span class="p">,</span><span class="n">CompareTime</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">CompareTime</span> <span class="o">==</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">startNum</span><span class="o">=</span><span class="n">i</span>
            <span class="nb">print</span> <span class="s1">&#39;start index number is &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">startNum</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">SensorStartTime</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">SensorGoalTime</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">55426</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">55426</span>
</pre></div>
</div>
<p>diff_index,diffに時系列データからあるインデックスとその次のインデックスのデータの差が10msではないインデックス
をdiff_indexにすべて格納する。そして、その時の差をdiffに格納する。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CalcDiffTimeArray</span><span class="p">(</span><span class="n">checkData</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">diff_index</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">checkData</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="o">!=</span><span class="mi">10</span><span class="p">:</span>
            <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">diff_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="nb">print</span> <span class="s1">&#39;Error Index Num=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; diff=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
            <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s Data =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">diff_index</span><span class="p">,</span><span class="n">diff</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5589</span> <span class="n">diff</span><span class="o">=</span><span class="mi">1330</span>
<span class="mi">5589</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65231650</span>
<span class="mi">5590</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65232980</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5650</span> <span class="n">diff</span><span class="o">=</span><span class="mi">3000</span>
<span class="mi">5650</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65233580</span>
<span class="mi">5651</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65236580</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5813</span> <span class="n">diff</span><span class="o">=</span><span class="mi">90</span>
<span class="mi">5813</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238200</span>
<span class="mi">5814</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238290</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5870</span> <span class="n">diff</span><span class="o">=</span><span class="mi">430</span>
<span class="mi">5870</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238850</span>
<span class="mi">5871</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65239280</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6266</span> <span class="n">diff</span><span class="o">=</span><span class="mi">140</span>
<span class="mi">6266</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243230</span>
<span class="mi">6267</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243370</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6302</span> <span class="n">diff</span><span class="o">=</span><span class="mi">20</span>
<span class="mi">6302</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243720</span>
<span class="mi">6303</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243740</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">([</span><span class="mi">5589</span><span class="p">,</span> <span class="mi">5650</span><span class="p">,</span> <span class="mi">5813</span><span class="p">,</span> <span class="mi">5870</span><span class="p">,</span> <span class="mi">6266</span><span class="p">,</span> <span class="mi">6302</span><span class="p">],</span> <span class="p">[</span><span class="mi">1330</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
<p>与えられた配列と、差が10ms生じるインデックスとその差の変数を2つ使って連続データを抽出し、そしてサンプル数に応じた幅の変数を返す</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CalcWindow</span><span class="p">(</span><span class="n">checkData</span><span class="p">,</span><span class="n">diff_index</span><span class="p">,</span><span class="n">diff</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">OuputData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">samp</span><span class="p">)</span>

    <span class="c1"># researve tmp%samp</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_index</span><span class="p">)</span> <span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span><span class="p">)]</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
        <span class="n">axis</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">remainder</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span>

        <span class="c1"># tmp elements must be over sample num</span>
        <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">samp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">axis</span> <span class="p">):</span>
                <span class="n">OuputData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OuputData</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]))</span>
        <span class="n">start</span> <span class="o">=</span><span class="n">diff_index</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">checkData</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span> <span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span><span class="p">)]</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>
    <span class="n">axis</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">remainder</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">%</span><span class="n">samp</span>

    <span class="k">if</span> <span class="n">tmp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">samp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">axis</span> <span class="p">):</span>
                <span class="n">OuputData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OuputData</span><span class="p">,</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>

    <span class="n">OuputData</span> <span class="o">=</span> <span class="n">OuputData</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">OuputData</span><span class="p">)</span><span class="o">/</span><span class="n">samp</span><span class="p">,</span><span class="n">samp</span><span class="p">)</span>

    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">start_time</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;elapsed_time:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;[sec]&quot;</span>
    <span class="k">return</span> <span class="n">OuputData</span>
</pre></div>
</div>
<p><strong>メインアルゴリズム windows抽出方法その２</strong> 1.
各センサの時系列データから共通区間のスタート、ゴールを計算 2.
共通区間のスタート、ゴールの時間が各センサにあるかどうか調べ、ある場合はそのインデックスを算出する
3.
2で算出した値をインデックスに追加したインデックスから共通区間のゴールまで間が連続データか調べる。調べる方法は、あるインデックスとその次のインデックスの差に10以外の結果があるインデックスと、その差を算出する。ここでは、インデックスをdiff_index,その差をdiff_numとする。
4.
3.で算出した情報を元に連続データの区間の最後インデックスをdiff_index[i]とする。そして、スタートは最初は0だがその後はdiff_index[i-1]とする。そして、その区間の大きさはサンプル数の倍数とする。そして、その区間を配列に入れその配列の列数をサンプル数と同じ値にする。diff_indexのすべての値を以上の計算したあと、配列に残りがある場合その区間も同様な計算をする</p>
<ol class="arabic simple" start="5">
<li><strong>Option</strong> 配列１つ一つをnumpyのファイルとして保存する</li>
</ol>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">TimeArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]]</span>
<span class="n">AccXArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;AccX&#39;</span><span class="p">]]</span>
<span class="n">AccYArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;AccY&#39;</span><span class="p">]]</span>
<span class="n">AccZArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;AccZ&#39;</span><span class="p">]]</span>
<span class="n">GyrXArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;GyrX&#39;</span><span class="p">]]</span>
<span class="n">GyrYArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;GyrY&#39;</span><span class="p">]]</span>
<span class="n">GyrZArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="n">check1</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">],</span><span class="n">check2</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">],</span><span class="n">check3</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">],</span><span class="n">check4</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">],</span><span class="n">check5</span><span class="p">[</span><span class="s1">&#39;GyrZ&#39;</span><span class="p">]]</span>
<span class="n">NameArrayList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sensor1&#39;</span><span class="p">,</span><span class="s1">&#39;Sensor2&#39;</span><span class="p">,</span><span class="s1">&#39;Sensor3&#39;</span><span class="p">,</span><span class="s1">&#39;Sensor4&#39;</span><span class="p">,</span><span class="s1">&#39;Sensor5&#39;</span><span class="p">]</span>
<span class="c1"># phase 1</span>
<span class="n">SensorStartTime</span> <span class="o">=</span> <span class="n">ClacStartTime</span><span class="p">(</span><span class="n">TimeArrayList</span><span class="p">)</span>
<span class="n">SensorGoalTime</span> <span class="o">=</span> <span class="n">ClacGoalTime</span><span class="p">(</span><span class="n">TimeArrayList</span><span class="p">)</span>

<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">TimeArrayList</span><span class="p">:</span>
<span class="c1"># phase 2</span>
    <span class="n">StartIndex</span> <span class="o">=</span> <span class="n">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">SensorStartTime</span><span class="p">)</span>
    <span class="n">GoalIndex</span> <span class="o">=</span> <span class="n">CalcSearchIndexFromTime</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">SensorGoalTime</span><span class="p">)</span>
<span class="c1"># phase 3</span>
    <span class="n">diffIndex</span><span class="p">,</span> <span class="n">diffNum</span><span class="o">=</span><span class="n">CalcDiffTimeArray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">arrayTime</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">arrayAccX</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">arrayAccY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">arrayAccZ</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">arrayGyrX</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">arrayGyrY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">arrayGyrZ</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>


<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">TimeArrayList</span><span class="p">:</span>
<span class="c1"># phase 4</span>
    <span class="n">arrayTime</span> <span class="o">=</span> <span class="n">CalcWindow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">StartIndex</span><span class="p">:</span><span class="n">GoalIndex</span><span class="p">],</span><span class="n">diffIndex</span><span class="p">,</span><span class="n">diffNum</span><span class="p">)</span>
    <span class="nb">print</span> <span class="n">arrayTime</span><span class="o">.</span><span class="n">shape</span>

<span class="k">for</span> <span class="n">AccX</span><span class="p">,</span><span class="n">AccY</span><span class="p">,</span><span class="n">AccZ</span><span class="p">,</span><span class="n">GyrX</span><span class="p">,</span><span class="n">GyrY</span><span class="p">,</span><span class="n">GyrZ</span><span class="p">,</span><span class="n">Name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">AccXArrayList</span><span class="p">,</span><span class="n">AccYArrayList</span><span class="p">,</span><span class="n">AccZArrayList</span><span class="p">,</span><span class="n">GyrXArrayList</span><span class="p">,</span><span class="n">GyrYArrayList</span><span class="p">,</span><span class="n">GyrZArrayList</span><span class="p">,</span><span class="n">NameArrayList</span><span class="p">):</span>
<span class="c1"># phase 4</span>
    <span class="n">arrayAccX</span> <span class="o">=</span><span class="n">CalcWindow</span><span class="p">(</span><span class="n">AccX</span><span class="p">[</span><span class="n">StartIndex</span><span class="p">:</span><span class="n">GoalIndex</span><span class="p">],</span><span class="n">diffIndex</span><span class="p">,</span><span class="n">diffNum</span><span class="p">)</span>
    <span class="n">arrayAccY</span> <span class="o">=</span><span class="n">CalcWindow</span><span class="p">(</span><span class="n">AccY</span><span class="p">[</span><span class="n">StartIndex</span><span class="p">:</span><span class="n">GoalIndex</span><span class="p">],</span><span class="n">diffIndex</span><span class="p">,</span><span class="n">diffNum</span><span class="p">)</span>
    <span class="n">arrayAccZ</span> <span class="o">=</span><span class="n">CalcWindow</span><span class="p">(</span><span class="n">AccZ</span><span class="p">[</span><span class="n">StartIndex</span><span class="p">:</span><span class="n">GoalIndex</span><span class="p">],</span><span class="n">diffIndex</span><span class="p">,</span><span class="n">diffNum</span><span class="p">)</span>
    <span class="n">arrayGyrX</span> <span class="o">=</span><span class="n">CalcWindow</span><span class="p">(</span><span class="n">GyrX</span><span class="p">[</span><span class="n">StartIndex</span><span class="p">:</span><span class="n">GoalIndex</span><span class="p">],</span><span class="n">diffIndex</span><span class="p">,</span><span class="n">diffNum</span><span class="p">)</span>
    <span class="n">arrayGyrY</span> <span class="o">=</span><span class="n">CalcWindow</span><span class="p">(</span><span class="n">GyrY</span><span class="p">[</span><span class="n">StartIndex</span><span class="p">:</span><span class="n">GoalIndex</span><span class="p">],</span><span class="n">diffIndex</span><span class="p">,</span><span class="n">diffNum</span><span class="p">)</span>
    <span class="n">arrayGyrZ</span> <span class="o">=</span><span class="n">CalcWindow</span><span class="p">(</span><span class="n">GyrZ</span><span class="p">[</span><span class="n">StartIndex</span><span class="p">:</span><span class="n">GoalIndex</span><span class="p">],</span><span class="n">diffIndex</span><span class="p">,</span><span class="n">diffNum</span><span class="p">)</span>

    <span class="n">axis</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="n">arrayAccX</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
        <span class="n">tmpAccX</span><span class="o">=</span><span class="n">arrayAccX</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">tmpAccY</span><span class="o">=</span><span class="n">arrayAccY</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">tmpAccZ</span><span class="o">=</span><span class="n">arrayAccZ</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">tmpGyrX</span><span class="o">=</span><span class="n">arrayGyrX</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">tmpGyrY</span><span class="o">=</span><span class="n">arrayGyrY</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">tmpGyrZ</span><span class="o">=</span><span class="n">arrayGyrZ</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span> <span class="p">(</span><span class="n">tmpAccX</span><span class="p">,</span><span class="n">tmpAccY</span><span class="p">,</span><span class="n">tmpAccZ</span><span class="p">,</span><span class="n">tmpGyrX</span><span class="p">,</span><span class="n">tmpGyrY</span><span class="p">,</span><span class="n">tmpGyrZ</span><span class="p">))</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">T</span>

        <span class="c1"># phase 5</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">WORKSPACE_PATH</span><span class="o">+</span><span class="s1">&#39;window/&#39;</span><span class="o">+</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">p</span> <span class="o">=</span> <span class="s1">&#39;/home/takeyama/pywork/ipython/2016-06-06/window/&#39;</span><span class="o">+</span><span class="n">Name</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">window</span><span class="p">)</span>
    <span class="nb">print</span> <span class="n">arrayAccX</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">18</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">55444</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">0</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">55426</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">22</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">55448</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">8</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">55434</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">13</span>
<span class="n">start</span> <span class="n">index</span> <span class="n">number</span> <span class="ow">is</span> <span class="mi">54944</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5589</span> <span class="n">diff</span><span class="o">=</span><span class="mi">1330</span>
<span class="mi">5589</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65231650</span>
<span class="mi">5590</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65232980</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5650</span> <span class="n">diff</span><span class="o">=</span><span class="mi">3000</span>
<span class="mi">5650</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65233580</span>
<span class="mi">5651</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65236580</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5813</span> <span class="n">diff</span><span class="o">=</span><span class="mi">90</span>
<span class="mi">5813</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238200</span>
<span class="mi">5814</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238290</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">5870</span> <span class="n">diff</span><span class="o">=</span><span class="mi">430</span>
<span class="mi">5870</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65238850</span>
<span class="mi">5871</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65239280</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6266</span> <span class="n">diff</span><span class="o">=</span><span class="mi">140</span>
<span class="mi">6266</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243230</span>
<span class="mi">6267</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243370</span>
<span class="n">Error</span> <span class="n">Index</span> <span class="n">Num</span><span class="o">=</span><span class="mi">6302</span> <span class="n">diff</span><span class="o">=</span><span class="mi">20</span>
<span class="mi">6302</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243720</span>
<span class="mi">6303</span><span class="n">s</span> <span class="n">Data</span> <span class="o">=</span><span class="mi">65243740</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146005868912</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.147639036179</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.14550614357</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146759986877</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.145116090775</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.144665002823</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.143926858902</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146833896637</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146371841431</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.147946834564</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.144592046738</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146854877472</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146552085876</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146040916443</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.145390987396</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.142467021942</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.145690202713</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.143049001694</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.14425110817</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.14282989502</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.143885850906</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.141743183136</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.143944978714</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.147487878799</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.143837928772</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.145770072937</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.144019842148</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.142317056656</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.144212961197</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.142785072327</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.146235942841</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.143010139465</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.143692016602</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.142290115356</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="n">elapsed_time</span><span class="p">:</span><span class="mf">0.145117998123</span><span class="p">[</span><span class="n">sec</span><span class="p">]</span>
<span class="p">(</span><span class="mi">6864</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">pwd</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s1">u&#39;/home/takeyama/Documents/AddingLabel+FFTdata&#39;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">window</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span>  <span class="mf">1.72500000e-01</span>   <span class="mf">1.57400000e-01</span>   <span class="mf">1.01000000e-01</span>   <span class="mf">7.15000000e-02</span>
    <span class="mf">4.29000000e-02</span>   <span class="mf">5.17000000e-02</span>   <span class="mf">5.14000000e-02</span>   <span class="mf">3.22000000e-02</span><span class="p">]</span>
 <span class="p">[</span> <span class="o">-</span><span class="mf">2.61400000e-01</span>  <span class="o">-</span><span class="mf">2.19700000e-01</span>  <span class="o">-</span><span class="mf">1.52500000e-01</span>  <span class="o">-</span><span class="mf">2.01600000e-01</span>
   <span class="o">-</span><span class="mf">2.46500000e-01</span>  <span class="o">-</span><span class="mf">2.32800000e-01</span>  <span class="o">-</span><span class="mf">2.11900000e-01</span>  <span class="o">-</span><span class="mf">1.96200000e-01</span><span class="p">]</span>
 <span class="p">[</span> <span class="o">-</span><span class="mf">1.17070000e+00</span>  <span class="o">-</span><span class="mf">1.18710000e+00</span>  <span class="o">-</span><span class="mf">1.14610000e+00</span>  <span class="o">-</span><span class="mf">1.15800000e+00</span>
   <span class="o">-</span><span class="mf">1.12160000e+00</span>  <span class="o">-</span><span class="mf">1.11630000e+00</span>  <span class="o">-</span><span class="mf">1.11140000e+00</span>  <span class="o">-</span><span class="mf">1.10040000e+00</span><span class="p">]</span>
 <span class="p">[</span> <span class="o">-</span><span class="mf">3.15000000e+01</span>  <span class="o">-</span><span class="mf">3.78400000e+01</span>  <span class="o">-</span><span class="mf">4.59300000e+01</span>  <span class="o">-</span><span class="mf">5.15300000e+01</span>
   <span class="o">-</span><span class="mf">4.92300000e+01</span>  <span class="o">-</span><span class="mf">3.85300000e+01</span>  <span class="o">-</span><span class="mf">2.92000000e+01</span>  <span class="o">-</span><span class="mf">2.17600000e+01</span><span class="p">]</span>
 <span class="p">[</span> <span class="o">-</span><span class="mf">5.33000000e+00</span>  <span class="o">-</span><span class="mf">7.74000000e+00</span>  <span class="o">-</span><span class="mf">1.00000000e+01</span>  <span class="o">-</span><span class="mf">9.54000000e+00</span>
   <span class="o">-</span><span class="mf">1.29300000e+01</span>  <span class="o">-</span><span class="mf">1.45200000e+01</span>  <span class="o">-</span><span class="mf">1.39300000e+01</span>  <span class="o">-</span><span class="mf">1.54400000e+01</span><span class="p">]</span>
 <span class="p">[</span> <span class="o">-</span><span class="mf">7.08300000e+01</span>  <span class="o">-</span><span class="mf">6.51100000e+01</span>  <span class="o">-</span><span class="mf">6.92100000e+01</span>  <span class="o">-</span><span class="mf">6.68000000e+01</span>
   <span class="o">-</span><span class="mf">5.94000000e+01</span>  <span class="o">-</span><span class="mf">5.64200000e+01</span>  <span class="o">-</span><span class="mf">5.72000000e+01</span>  <span class="o">-</span><span class="mf">6.43100000e+01</span><span class="p">]]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">window</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[[</span>  <span class="mf">1.72500000e-01</span>  <span class="o">-</span><span class="mf">2.61400000e-01</span>  <span class="o">-</span><span class="mf">1.17070000e+00</span>  <span class="o">-</span><span class="mf">3.15000000e+01</span>
   <span class="o">-</span><span class="mf">5.33000000e+00</span>  <span class="o">-</span><span class="mf">7.08300000e+01</span><span class="p">]</span>
 <span class="p">[</span>  <span class="mf">1.57400000e-01</span>  <span class="o">-</span><span class="mf">2.19700000e-01</span>  <span class="o">-</span><span class="mf">1.18710000e+00</span>  <span class="o">-</span><span class="mf">3.78400000e+01</span>
   <span class="o">-</span><span class="mf">7.74000000e+00</span>  <span class="o">-</span><span class="mf">6.51100000e+01</span><span class="p">]</span>
 <span class="p">[</span>  <span class="mf">1.01000000e-01</span>  <span class="o">-</span><span class="mf">1.52500000e-01</span>  <span class="o">-</span><span class="mf">1.14610000e+00</span>  <span class="o">-</span><span class="mf">4.59300000e+01</span>
   <span class="o">-</span><span class="mf">1.00000000e+01</span>  <span class="o">-</span><span class="mf">6.92100000e+01</span><span class="p">]</span>
 <span class="p">[</span>  <span class="mf">7.15000000e-02</span>  <span class="o">-</span><span class="mf">2.01600000e-01</span>  <span class="o">-</span><span class="mf">1.15800000e+00</span>  <span class="o">-</span><span class="mf">5.15300000e+01</span>
   <span class="o">-</span><span class="mf">9.54000000e+00</span>  <span class="o">-</span><span class="mf">6.68000000e+01</span><span class="p">]</span>
 <span class="p">[</span>  <span class="mf">4.29000000e-02</span>  <span class="o">-</span><span class="mf">2.46500000e-01</span>  <span class="o">-</span><span class="mf">1.12160000e+00</span>  <span class="o">-</span><span class="mf">4.92300000e+01</span>
   <span class="o">-</span><span class="mf">1.29300000e+01</span>  <span class="o">-</span><span class="mf">5.94000000e+01</span><span class="p">]</span>
 <span class="p">[</span>  <span class="mf">5.17000000e-02</span>  <span class="o">-</span><span class="mf">2.32800000e-01</span>  <span class="o">-</span><span class="mf">1.11630000e+00</span>  <span class="o">-</span><span class="mf">3.85300000e+01</span>
   <span class="o">-</span><span class="mf">1.45200000e+01</span>  <span class="o">-</span><span class="mf">5.64200000e+01</span><span class="p">]</span>
 <span class="p">[</span>  <span class="mf">5.14000000e-02</span>  <span class="o">-</span><span class="mf">2.11900000e-01</span>  <span class="o">-</span><span class="mf">1.11140000e+00</span>  <span class="o">-</span><span class="mf">2.92000000e+01</span>
   <span class="o">-</span><span class="mf">1.39300000e+01</span>  <span class="o">-</span><span class="mf">5.72000000e+01</span><span class="p">]</span>
 <span class="p">[</span>  <span class="mf">3.22000000e-02</span>  <span class="o">-</span><span class="mf">1.96200000e-01</span>  <span class="o">-</span><span class="mf">1.10040000e+00</span>  <span class="o">-</span><span class="mf">2.17600000e+01</span>
   <span class="o">-</span><span class="mf">1.54400000e+01</span>  <span class="o">-</span><span class="mf">6.43100000e+01</span><span class="p">]]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># 2次元配列のHstackの効果</span>
<span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>

<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">c</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/home/takeyama/pywork/ipython/2016-06-06/window/&#39;</span><span class="o">+</span><span class="s1">&#39;test.npy&#39;</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">IOError</span>                                   <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">301</span><span class="o">-</span><span class="mi">5</span><span class="n">a60736e7669</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">5</span> <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
      <span class="mi">6</span> <span class="n">c</span>
<span class="o">----&gt;</span> <span class="mi">7</span> <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/home/takeyama/pywork/ipython/2016-06-06/window/&#39;</span><span class="o">+</span><span class="s1">&#39;test.npy&#39;</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>


<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">takeyama</span><span class="o">/.</span><span class="n">pyenv</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="mf">2.7</span><span class="o">.</span><span class="mi">11</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">my_work</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">npyio</span><span class="o">.</span><span class="n">pyc</span> <span class="ow">in</span> <span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="p">,</span> <span class="n">fix_imports</span><span class="p">)</span>
    <span class="mi">475</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.npy&#39;</span><span class="p">):</span>
    <span class="mi">476</span>             <span class="n">file</span> <span class="o">=</span> <span class="n">file</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span>
<span class="o">--&gt;</span> <span class="mi">477</span>         <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
    <span class="mi">478</span>         <span class="n">own_fid</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="mi">479</span>     <span class="k">else</span><span class="p">:</span>


<span class="ne">IOError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">2</span><span class="p">]</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span><span class="p">:</span> <span class="s1">&#39;/home/takeyama/pywork/ipython/2016-06-06/window/test.npy&#39;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># 列指定して、転値ができるかどうか</span>
<span class="nb">print</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
<span class="nb">print</span> <span class="n">a</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
<p>具体的なnumpyのloadtxt,genfromtxtの違い</p>
<p>np.loadtxt(&#8216;left-hand.csv&#8217;,delimiter=&#8217;,&#8217;,usecols=(2,3,4))</p>
<p>np.genfromtxt(&#8216;left-hand.csv&#8217;,delimiter=&#8217;,&#8217;,usecols=(2,3,4))</p>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to Preprocessing&#8217;s documentation!</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/making_class_Preprocessing.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Tohru Takeyama.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/making_class_Preprocessing.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>